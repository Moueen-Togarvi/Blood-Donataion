{% extends 'main.html' %}
{% block content %}
<style>
  .form-grid-responsive {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  @media (max-width: 600px) {
    .form-grid-responsive {
      grid-template-columns: 1fr !important;
    }

    .auth-box-custom {
      padding: 0.5rem 0 !important;
    }

    .card-custom {
      padding: 1.5rem 1rem !important;
    }

    .available-card-custom {
      flex-direction: column !important;
      align-items: flex-start !important;
      gap: 1.5rem !important;
    }
  }
</style>
<main class="container">
  <div class="auth-box auth-box-custom" style="padding: 1rem 0;">
    <div class="card card-custom" style="padding: 1.5rem; border-radius: 1rem; max-width: 550px; margin: 0 auto;">

      {% if page == 'login' %}
      <!-- Login Page -->
      <div class="card__header"
        style="justify-content: center; flex-direction: column; align-items: center; border-bottom: 1px solid var(--color-border); padding-bottom: 1rem; margin-bottom: 1.5rem;">
        <h3 style="font-size: 1.8rem; font-weight: 700; color: var(--color-text-main);">Welcome Back</h3>
        <p style="color: var(--color-text-muted); font-size: 1.2rem;">Login to manage your donor profile.</p>
      </div>

      <form class="form" action="" method="POST">
        {% csrf_token %}
        <div class="form-group">
          <label for="username" class="form-label">Email</label>
          <input id="username" class="form-input" name="email" type="email" placeholder="e.g. user@email.com" />
        </div>
        <div class="form-group">
          <label for="password" class="form-label">Password</label>
          <input id="password" class="form-input" name="password" type="password" placeholder="••••••••" />
        </div>

        <button class="btn btn--primary" type="submit"
          style="width: 100%; margin-top: 0.5rem; padding: 0.8rem;">Login</button>
      </form>

      <div style="text-align: center; margin-top: 1.5rem; font-size: 1.3rem;">
        <p style="color: var(--color-text-muted);">Don't have an account?</p>
        <a href="{% url 'register' %}" style="color: var(--color-primary); font-weight: 600;">Register as Donor</a>
      </div>

      {% else %}
      <!-- Register Page -->
      <div class="card__header"
        style="justify-content: center; flex-direction: column; align-items: center; border-bottom: 1px solid var(--color-border); padding-bottom: 1rem; margin-bottom: 1.5rem;">
        <h3 style="font-size: 1.8rem; font-weight: 700; color: var(--color-text-main);">Register as Donor</h3>
        <p style="color: var(--color-text-muted); font-size: 1.2rem;">Join the community to save lives.</p>
      </div>

      <form class="form" action="" method="POST">
        {% csrf_token %}

        <div class="form-grid-responsive">
          {% for field in form %}
          {% if field.name == 'is_donor' %}
          {# handled below loop #}
          {% else %}
          <div class="form-group">
            <label for="{{field.id_for_label}}" class="form-label">{{field.label}}</label>
            <div style="display: flex; align-items: center; gap: 0.5rem;">
              {{field}}
              {% if field.name == 'hospital_distance' %}
              <span style="font-size: 1.4rem; font-weight: 600; color: var(--color-text-muted);">km</span>
              {% endif %}
            </div>
          </div>
          {% endif %}
          {% endfor %}
        </div>


        <div style="margin: 1rem 0;">
          <div class="available-card-custom"
            style="display: flex; align-items: center; justify-content: space-between; padding: 1rem 1.2rem; background: #ecfdf5; border: 2px solid #10b981; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div
                style="background: #10b981; color: white; padding: 0.6rem; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path
                    d="M8 1a1 1 0 0 1 1 1v2.101a7.002 7.002 0 0 1 1.902 12.636a1 1 0 0 1-1.03-1.713a5 5 0 1 0-3.744 0a1 1 0 0 1-1.03 1.713A7.002 7.002 0 0 1 7 4.101V2a1 1 0 0 1 1-1zm0 3.5a1.5 1.5 0 1 1 0 3a1.5 1.5 0 0 1 0-3z" />
                </svg>
              </div>
              <div>
                <label class="form-label"
                  style="margin: 0; font-size: 1.4rem; font-weight: 800; color: #065f46;">Available for Donation</label>
                <p style="margin: 0; font-size: 1rem; color: #047857;">Join the list of available donors.</p>
              </div>
            </div>
            <div style="transform: scale(1.4); margin-right: 1rem; cursor: pointer;">
              {{form.is_donor}}
            </div>
          </div>
        </div>

        <button class="btn btn--primary" type="submit"
          style="width: 100%; margin-top: 0.5rem; padding: 0.8rem;">Register</button>
      </form>

      <div style="text-align: center; margin-top: 1.5rem; font-size: 1.3rem;">
        <p style="color: var(--color-text-muted);">Already have an account?</p>
        <a href="{% url 'login' %}" style="color: var(--color-primary); font-weight: 600;">Login</a>
      </div>
      {% endif %}

    </div>
  </div>
</main>
{% endblock content %}